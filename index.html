<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ“º TVç›´æ’­ç«™ - ç»¿è‰²ç§‘æŠ€ç‰ˆ</title>
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<style>
  /* èƒŒæ™¯æµåŠ¨åŠ¨ç”» */
  body {
    margin: 0;
    font-family: "Microsoft YaHei", sans-serif;
    background: linear-gradient(270deg, #00c9ff, #92fe9d);
    background-size: 400% 400%;
    animation: gradientBG 15s ease infinite;
    color: #fff;
    text-align: center;
    transition: background 0.5s, color 0.5s;
  }
  @keyframes gradientBG {
    0% {background-position: 0% 50%;}
    50% {background-position: 100% 50%;}
    100% {background-position: 0% 50%;}
  }
  h1 { margin: 1rem 0; font-size: 2rem; }
  #player { width: 90%; max-width: 720px; margin: 0 auto; border-radius: 20px; overflow: hidden; box-shadow: 0 0 20px rgba(0,0,0,0.4); }
  input[type="text"] { margin: 1rem auto; padding: 0.6rem; border-radius: 10px; border: none; width: 80%; max-width: 500px; font-size: 1rem; display: block; }
  .group { margin: 1rem; background: rgba(255,255,255,0.1); border-radius: 15px; padding: 1rem; transition: background 0.5s; }
  .group h3 { cursor: pointer; font-size: 1.2rem; margin-bottom: 0.5rem; }
  ul { list-style: none; padding: 0; margin: 0; }
  li { display: flex; align-items: center; background: rgba(0,0,0,0.2); margin: 0.4rem 0; padding: 0.6rem; border-radius: 10px; cursor: pointer; transition: background 0.3s; }
  li:hover { background: rgba(0,0,0,0.4); }
  li img { width: 50px; height: 50px; margin-right: 10px; border-radius: 10px; object-fit: cover; background: #fff; }
  #currentChannel { margin-top: 1rem; font-weight: bold; color: #ffffcc; font-size: 1.2rem; }
  .language-toggle { margin-top: 1rem; cursor: pointer; font-size: 1rem; text-decoration: underline; }
  .external-player { margin-top: 1rem; font-size: 0.9rem; }
  .top-right-buttons { position: fixed; top: 1rem; right: 1rem; display: flex; gap: 0.5rem; z-index: 999; }
  .top-button { background: rgba(0,0,0,0.3); color: #fff; padding: 0.6rem 0.8rem; border-radius: 50%; font-size: 1.2rem; cursor: pointer; backdrop-filter: blur(5px); transition: background 0.3s; }
  .top-button:hover { background: rgba(0,0,0,0.5); }

  /* å¤œé—´æ¨¡å¼ */
  body.night-mode { background: linear-gradient(270deg, #000428, #004e92); color: #cccccc; }
  body.night-mode .group { background: rgba(0,0,0,0.4); }
  body.night-mode li { background: rgba(255,255,255,0.1); }
  body.night-mode li:hover { background: rgba(255,255,255,0.2); }

  /* ç®€æ´æ¨¡å¼ */
  body.simple-mode h1, body.simple-mode input[type="text"], body.simple-mode .language-toggle { display: none; }
  body.simple-mode li { padding: 0.4rem; font-size: 0.9rem; }
  body.simple-mode li img { width: 40px; height: 40px; }
  body.simple-mode .group { padding: 0.5rem; }

  @media (max-width: 768px) {
    li img { width: 40px; height: 40px; }
    #player { width: 100%; }
  }
</style>
</head>

<body>
<h1>ğŸ“º TVç›´æ’­ç«™ - ç»¿è‰²ç§‘æŠ€ç‰ˆ</h1>
<div id="currentChannel">å½“å‰æœªæ’­æ”¾é¢‘é“</div>
<video id="player" controls autoplay></video>
<input type="text" id="search" placeholder="ğŸ” æœç´¢é¢‘é“..." onkeyup="filterChannels()">
<div id="channelList"></div>
<div class="external-player" id="externalLink"></div>
<div class="language-toggle" onclick="toggleLanguage()">ğŸŒ åˆ‡æ¢è¯­è¨€</div>
<div class="top-right-buttons">
  <div class="top-button" onclick="toggleNightMode()" id="nightBtn">ğŸŒ™</div>
  <div class="top-button" onclick="toggleSimpleMode()" id="simpleBtn">ğŸ¯</div>
</div>

<script>
const channels = [
  { group: "ğŸ“º CCTVé¢‘é“", list: [
    { name: "CCTV-1 ç»¼åˆ", logo: "https://i.postimg.cc/sX8wv2q2/cctv1.png", urls: ["https://example.com/cctv1_hd.m3u8"] },
    { name: "CCTV-5 ä½“è‚²", logo: "https://i.postimg.cc/qM1Bxw3R/cctv5.png", urls: ["https://example.com/cctv5_hd.m3u8"] }
  ]}
];

let currentLang = "zh", currentChannelUrls = [], currentChannelIndex = 0;

function loadChannels() {
  const channelDiv = document.getElementById('channelList');
  channelDiv.innerHTML = '';
  channels.forEach(group => {
    const groupDiv = document.createElement('div');
    groupDiv.className = 'group';
    const groupTitle = document.createElement('h3');
    groupTitle.innerText = group.group;
    groupTitle.onclick = () => {
      const list = groupDiv.querySelector('ul');
      list.style.display = list.style.display === 'none' ? 'block' : 'none';
    };
    const ul = document.createElement('ul');
    group.list.forEach(channel => {
      const li = document.createElement('li');
      li.innerHTML = `<img src="${channel.logo}" alt=""> ${channel.name}`;
      li.onclick = () => playChannel(channel.urls, channel.name);
      ul.appendChild(li);
    });
    groupDiv.appendChild(groupTitle);
    groupDiv.appendChild(ul);
    channelDiv.appendChild(groupDiv);
  });
}

function playChannel(urls, name) {
  currentChannelUrls = urls;
  currentChannelIndex = 0;
  document.getElementById('currentChannel').innerText = `æ­£åœ¨æ’­æ”¾: ${name}`;
  document.getElementById('externalLink').innerHTML = `<a href="${urls[0]}" target="_blank" style="color:yellow;">ğŸ“¥ å¤–éƒ¨æ’­æ”¾å™¨æ‰“å¼€</a>`;
  localStorage.setItem('lastChannel', JSON.stringify({urls, name}));
  playUrl(urls[0]);
}

function playUrl(url) {
  const video = document.getElementById('player');
  if (Hls.isSupported()) {
    const hls = new Hls();
    hls.loadSource(url);
    hls.attachMedia(video);
    hls.on(Hls.Events.ERROR, function (event, data) {
      if (data.fatal) {
        switch (data.type) {
          case Hls.ErrorTypes.NETWORK_ERROR: switchLine(); break;
        }
      }
    });
  } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
    video.src = url;
  }
}

function switchLine() {
  currentChannelIndex++;
  if (currentChannelIndex < currentChannelUrls.length) playUrl(currentChannelUrls[currentChannelIndex]);
  else alert('æ‰€æœ‰çº¿è·¯æ’­æ”¾å¤±è´¥ï¼Œè¯·ç¨åå†è¯•ã€‚');
}

function filterChannels() {
  const input = document.getElementById('search').value.toLowerCase();
  document.querySelectorAll('.group').forEach(group => {
    let hasVisible = false;
    group.querySelectorAll('li').forEach(li => {
      if (li.innerText.toLowerCase().includes(input)) { li.style.display = ''; hasVisible = true; }
      else li.style.display = 'none';
    });
    group.style.display = hasVisible ? '' : 'none';
  });
}

function toggleLanguage() {
  currentLang = currentLang === "zh" ? "en" : "zh";
  document.querySelectorAll('.group h3').forEach(h3 => {
    if (currentLang === "en") h3.innerText = h3.innerText.replace('é¢‘é“', ' Channels').replace('å›½å¤–', 'International');
    else h3.innerText = h3.innerText.replace('Channels', 'é¢‘é“').replace('International', 'å›½å¤–');
  });
  document.querySelector('.language-toggle').innerText = currentLang === "zh" ? "ğŸŒ åˆ‡æ¢è¯­è¨€" : "ğŸŒ Switch Language";
}

function toggleNightMode() {
  document.body.classList.toggle('night-mode');
  document.getElementById('nightBtn').innerText = document.body.classList.contains('night-mode') ? "â˜€ï¸" : "ğŸŒ™";
  localStorage.setItem('nightMode', document.body.classList.contains('night-mode'));
}

function toggleSimpleMode() {
  document.body.classList.toggle('simple-mode');
  localStorage.setItem('simpleMode', document.body.classList.contains('simple-mode'));
}

window.onload = function() {
  loadChannels();
  const last = JSON.parse(localStorage.getItem('lastChannel'));
  if (last) playChannel(last.urls, last.name);
  if (localStorage.getItem('nightMode') === 'true') {
    document.body.classList.add('night-mode');
    document.getElementById('nightBtn').innerText = "â˜€ï¸";
  }
  if (localStorage.getItem('simpleMode') === 'true') {
    document.body.classList.add('simple-mode');
  }
}
</script>

</body>
</html>
