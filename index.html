<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>📺 小晰良TV直播站 </title>
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<style>
:root {
  --main-bg: linear-gradient(270deg, #00c9ff, #92fe9d);
  --text-color: #fff;
  --card-bg: rgba(255,255,255,0.1);
  --hover-bg: rgba(0,0,0,0.4);
  --button-bg: #00c9ff;
  --highlight-color: yellow;
}
body.dark {
  --main-bg: #111;
  --text-color: #ddd;
  --card-bg: rgba(255,255,255,0.05);
  --hover-bg: rgba(255,255,255,0.1);
  --button-bg: #444;
  --highlight-color: yellow;
}
body {
  margin: 0;
  font-family: "Microsoft YaHei", sans-serif;
  background: var(--main-bg);
  background-size: 400% 400%;
  animation: gradientBG 15s ease infinite;
  color: var(--text-color);
  text-align: center;
}
@keyframes gradientBG {
  0% {background-position: 0% 50%;}
  50% {background-position: 100% 50%;}
  100% {background-position: 0% 50%;}
}
h1 {
  margin: 1rem 0;
  font-size: 2rem;
}
#player {
  width: 90%;
  max-width: 720px;
  margin: 0 auto;
  border-radius: 20px;
  overflow: hidden;
  box-shadow: 0 0 20px rgba(0,0,0,0.4);
}
input[type="text"] {
  margin: 1rem auto;
  padding: 0.6rem;
  border-radius: 10px;
  border: none;
  width: 80%;
  max-width: 500px;
  font-size: 1rem;
  display: block;
}
.group {
  margin: 1rem;
  background: var(--card-bg);
  border-radius: 15px;
  padding: 1rem;
}
.group h3 {
  cursor: pointer;
  font-size: 1.2rem;
  margin-bottom: 0.5rem;
}
ul {
  list-style: none;
  padding: 0;
  margin: 0;
}
li {
  display: flex;
  align-items: center;
  justify-content: space-between;
  background: var(--card-bg);
  margin: 0.4rem 0;
  padding: 0.6rem;
  border-radius: 10px;
  cursor: pointer;
  transition: background 0.3s;
}
li:hover {
  background: var(--hover-bg);
}
li img {
  width: 50px;
  height: 50px;
  margin-right: 10px;
  border-radius: 10px;
  object-fit: cover;
  background: #fff;
}
button {
  background: var(--button-bg);
  color: #fff;
  border: none;
  border-radius: 10px;
  padding: 0.5rem 1rem;
  margin: 0.3rem;
  cursor: pointer;
}
#currentChannel {
  margin-top: 1rem;
  font-weight: bold;
  font-size: 1.2rem;
}
#countdown {
  margin-top: 0.5rem;
  font-weight: bold;
  font-size: 1.1rem;
  color: var(--highlight-color);
}
@media (max-width: 768px) {
  li img { width: 40px; height: 40px; }
  #player { width: 100%; }
}
</style>
</head>
<body>
<h1>📺 小晰良TV直播站</h1>
<div id="currentChannel">当前未播放</div>
<div id="countdown"></div>
<video id="player" controls autoplay></video>
<input type="text" id="search" placeholder="🔍 搜索频道..." onkeyup="filterChannels()">
<div id="channelList"></div>
<div id="externalLink"></div>
<button onclick="toggleLanguage()">🌐 切换语言</button>
<button onclick="toggleDarkMode()">🌙 黑暗模式</button>
<script>
const channels = [
  {
    group: "📺 CCTV频道",
    list: [
      { name: "CCTV-1", logo: "https://i.postimg.cc/sX8wv2q2/cctv1.png", urls: ["https://example.com/cctv1_hd.m3u8"], epg: "19:30 第一剧场" },
      { name: "CCTV-5", logo: "https://i.postimg.cc/qM1Bxw3R/cctv5.png", urls: ["https://example.com/cctv5_hd.m3u8"], epg: "20:00 NBA直播" }
    ]
  }
];
let currentChannel = {};
function loadChannels() {
  const listDiv = document.getElementById('channelList');
  listDiv.innerHTML = '';
  channels.forEach(group => {
    const gDiv = document.createElement('div');
    gDiv.className = 'group';
    const h3 = document.createElement('h3');
    h3.innerText = group.group;
    h3.onclick = () => gDiv.querySelector('ul').style.display = gDiv.querySelector('ul').style.display==='none'?'block':'none';
    const ul = document.createElement('ul');
    group.list.forEach(channel => {
      const li = document.createElement('li');
      li.innerHTML = `<div style='display:flex;align-items:center;'><img src="${channel.logo}"> ${channel.name}</div>` +
        `<div><button onclick='favorite(event,"${channel.name}")'>❤️</button></div>`;
      li.onclick = e => { if(!e.target.closest('button')) play(channel); };
      ul.appendChild(li);
    });
    gDiv.appendChild(h3);
    gDiv.appendChild(ul);
    listDiv.appendChild(gDiv);
  });
}
function play(channel) {
  currentChannel = channel;
  const player = document.getElementById('player');
  player.src = channel.urls[0];
  document.getElementById('currentChannel').innerText = `正在播放: ${channel.name}`;
  document.getElementById('externalLink').innerHTML = `<a href='${channel.urls[0]}' target='_blank' style='color:yellow'>在外部播放器打开</a>`;
  localStorage.setItem('lastChannel', JSON.stringify(channel));
  countdownToShow(channel.epg);
}
function filterChannels() {
  const input = document.getElementById('search').value.toLowerCase();
  document.querySelectorAll('.group').forEach(g => {
    let show = false;
    g.querySelectorAll('li').forEach(li => {
      if (li.innerText.toLowerCase().includes(input)) {
        li.style.display = '';
        show = true;
      } else {
        li.style.display = 'none';
      }
    });
    g.style.display = show ? '' : 'none';
  });
}
function toggleLanguage() {
  document.querySelectorAll('.group h3').forEach(h => h.innerText = h.innerText.includes('CCTV') ? 'International Channels' : '📺 CCTV频道');
}
function toggleDarkMode() {
  document.body.classList.toggle('dark');
}
function countdownToShow(epg) {
  if (!epg) return document.getElementById('countdown').innerText = '';
  document.getElementById('countdown').innerText = `节目揭示: ${epg}`;
}
function favorite(e, name) {
  e.stopPropagation();
  alert(`已收藏: ${name}`);
}
window.onload = () => {
  loadChannels();
  const last = JSON.parse(localStorage.getItem('lastChannel'));
  if (last) play(last);
}
</script>
</body>
</html>
